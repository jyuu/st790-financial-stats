---
output: 
  pdf_document:
    keep_tex: true
    fig_caption: true
    template: ~/workspace/cv/git/svm-latex-ms.tex
title: "Homework 1"
author: "Joyce Yu Cahoon"
#abstract: "Application of sequential monte carlo (SMC) to the development of IM plausibility functions for the Nile."
# bibliography: /Users/jcahoon/workspace/metar/ref.bib
#bibliography: /home/joyce/workspace/metar/ref.bib
date: "`r format(Sys.time(), '%B %d, %Y')`"
geometry: margin=1in
fontfamily: mathpazo
fontsize: 11pt
# spacing: double
endnote: no
header-includes:
- \setlength{\abovedisplayskip}{.2pt}
- \setlength{\belowdisplayskip}{.2pt}
- \usepackage{placeins}
- \usepackage{setspace}
- \usepackage{chngcntr}
- \usepackage{multicol}
- \usepackage{lscape}
- \counterwithin{figure}{section}
- \counterwithin{table}{section}
- \usepackage{mathrsfs}
- \usepackage{mathtools}
- \usepackage{multirow}
- \newtheorem{theorem}{Theorem}
- \usepackage[linesnumbered,algoruled,boxed,lined,commentsnumbered]{algorithm2e} 
- \usepackage{bm}
- \usepackage{framed}
- \usepackage{xcolor}
- \colorlet{shadecolor}{orange!15}
# - \renewenvironment{quote}{\begin{shaded*}\begin{quote}}{\end{quote}\end{shaded*}}
--- 

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
```

1.1  

Download the daily, weekly and monthly prices for the Nasdaq index and the IBM stock from Yahoo. Reproduce figures 1.3-8 using the Nasdaq index and the IBM stock data. For 1.1, using the data from Jan 1985 - Aug 2018.

```{r, warning = FALSE, message = FALSE, cache = TRUE}
# Download the data
library(quantmod)
# start <- as.Date("1985-01-01")
# end <- as.Date("2018-08-29")
# getSymbols("^IXIC", src = "yahoo", from = start, to = end)
# getSymbols("IBM", src = "yahoo", from = start, to = end)
# save to avoid reloading 
# saveRDS(IXIC, "~/workspace/st790-financial-stats/data/ixic.rds")
# saveRDS(IBM, "~/workspace/st790-financial-stats/data/ibm.rds")
```

For NASDAQ: 

```{r, warning = FALSE, message = FALSE, cache = TRUE}
# Read in data 
IXIC <- readRDS("~/workspace/st790-financial-stats/data/ixic.rds")
IBM <- readRDS("~/workspace/st790-financial-stats/data/ibm.rds")
# Extract
daily <- log(dailyReturn(IXIC)+1)
weekly <- log(weeklyReturn(IXIC)+1)
monthly <- log(monthlyReturn(IXIC)+1)
# Plot 
par(mar=c(1,3,2,1),mfrow=c(4,1)) 
plot(index(IXIC), as.numeric(IXIC$IXIC.Close), type = "l", 
     ylab = "daily price")
plot(index(daily), daily, type = "l", 
     ylab="daily log return")
plot(index(weekly), weekly, type = "l",
     ylab="weekly log return")
plot(index(monthly), monthly, type = "l", 
     ylab="monthly log return")
```

For IBM: 

```{r, warning = FALSE, message = FALSE, cache = TRUE}
# Extract
daily <- log(dailyReturn(IBM)+1)
weekly <- log(weeklyReturn(IBM)+1)
monthly <- log(monthlyReturn(IBM)+1)
# Plot 
par(mar=c(1,3,2,1),mfrow=c(4,1)) 
plot(index(IBM), as.numeric(IBM$IBM.Close), type = "l", 
     ylab = "daily price")
plot(index(daily), daily, type = "l", 
     ylab="daily log return")
plot(index(weekly), weekly, type = "l",
     ylab="weekly log return")
plot(index(monthly), monthly, type = "l", 
     ylab="monthly log return")
```


1.3
Consider the following quote from Eugene Fama who was Myron Scholes' thesis adviser: "If the population of prices changes is strictly normal, on the average for any stock... an observation more than 5 standard deviations from the mean should be observed once every 7000 years. In fact such observations seem to occur about once every 3 or 5 years." For $X \sim N(\mu, \sigma^2), P(|X-\mu| > 5\sigma) = 5.733 \times 10^{-7}$, deduce how many observations per year Fama was implicitly assumining to be made. If a year is defined as 252 trading days and daily returns are normal, how many years is it expected to take to get a 5 standard deviation event? How does this answwer to the last question change when the daily returns follow the t-distribution with 4 degrees of freedom? 

1.8 
According to the efficient market hypothesis, is the return of a portfolio predictable? Is the volatility of a portfolio predictable? State the most appropriate mathematical form of the efficient market hypothesis. 

1.9
If the Ljung-Box test is employed to test the efficient market hypothesis, what null hypothesis is to be tested? If the autocorrelation for the first 4 lags of the montly log-returns of the S\&P500 is: 

$$
\hat{\rho}(1) = .2, \quad \hat{\rho}(2) = -0.15, \quad \hat{\rho}(3) = 0.25, \quad \hat{\rho}(4) = 0.12
$$
based on the last 5 years of data, is the efficient market hypothesis reasonable? 

1.13
Let $S_t$ be the price of an asset at time $t$. One version of the EMH assumes that the prices of any asset form a martingale process in the sense that: 

$$
E(S_{t+1}|S_t, S_{t-1}, \ldots ) = S_t \quad \forall t
$$

To understand the implication of this assumption, we consider the following simple investment strategy. With initial capital $C_0$ dollars, at the time $t$ we hold $\alpha_t$ dollars in cash and $\beta_t$ shares of an asset at the price $S_t$. Hence the value of our investment at time $t$ is $C_t=\alpha_t + \beta_t S_t$. Suppose that our investment is self-financing in the sense that 

$$
C_{t+1} = \alpha_t + \beta_t S_{t+1} = \alpha_{t+1} + \beta_{t+1} S_{t+1}
$$

and our investment strategy is entirely determined by the asset prices up to the time $t$. Show that if $S_t$ is a martingale process, there exist no strategies such that $C_{t+1} > C_t$ with probability 1. 
